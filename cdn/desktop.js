(()=>{"use strict";const e=JSON.parse('{"u2":{"ja":"年齢自動計算プラグイン"}}').u2.ja,t="ribbit-kintone-plugin",n=()=>{const n=(()=>{const e=localStorage.getItem(t);if(!e)return{};try{const t=JSON.parse(e);return"object"==typeof t?t:{}}catch(e){return{}}})();n.pluginNames=n.pluginNames||[],n.pluginNames.includes(e)||n.pluginNames.push(e),localStorage.setItem(t,JSON.stringify(n))};const r=class{_pluginId;constructor(e){this._pluginId=e;try{n()}catch(e){}}launch=t=>{for(const n of t){const{enables:t=(()=>!0),events:r=["app.record.index.show"],action:o,disableMobile:s=!1}=n,i="function"==typeof r?r(this._pluginId):r,c=s?[]:i.map((e=>"mobile."+e)),a=n=>{try{return t(n)?o(n,this._pluginId):n}catch(t){n.error=`プラグイン「${e}」の処理内でエラーが発生しました。`}return n};kintone.events.on([...i,...c],a)}}},o=e=>{const t=kintone.plugin.app.getConfig(e);return Object.keys(t).length?Object.entries(t).reduce(((e,[t,n])=>({...e,[t]:JSON.parse(n)})),{}):s()},s=()=>({rows:[i()]}),i=()=>({src:"",dst:"",updates:!1}),c={events:["app.record.create.show","app.record.edit.show","app.record.index.edit.show"],action:async(e,t)=>{const n=o(t);if(!n||!n.rows.length)return e;window.AGE_PLUGIN=window.AGE_PLUGIN||{},window.AGE_PLUGIN.initialValues=[];for(const{src:t,dst:r}of n.rows)e.record[r].disabled=!0,window.AGE_PLUGIN.initialValues.push(e.record[t].value);return e}},a={events:["app.record.index.edit.submit","app.record.create.submit","app.record.edit.submit"],action:async(e,t)=>{const n=o(t);if(!n||!n.rows.length||!window.AGE_PLUGIN)return e;for(let t=0;t<n.rows.length;t++){const{src:r,dst:o,updates:s}=n.rows[t],i=window.AGE_PLUGIN.initialValues[t];if(!e.type.includes("record.create")&&!s&&(i||e.record[o].value))continue;const c=e.record[r].value;if(!c){e.record[o].value="";continue}const a=u(new Date(c));e.record[o].value=isFinite(a)?a:NaN}return e}},u=e=>{const t=e.getFullYear(),n=e.getMonth(),r=e.getDate(),o=new Date,s=o.getFullYear(),i=o.getMonth(),c=o.getDate(),a=s-t;return i>n||i===n&&c>=r?a:a-1};var l;l=kintone.$PLUGIN_ID,new r(l).launch([c,a])})();